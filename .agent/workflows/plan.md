---
description: 要件を整理し、リスクを評価し、段階的な実装計画を作成。コードを触る前に必ずユーザーの確認を待つ。
---

# /plan - 実装計画コマンド

複雑な機能やリファクタリングの前に、包括的な実装計画を作成します。

## 使用タイミング

- 新機能の開発開始時
- 大規模なアーキテクチャ変更
- 複雑なリファクタリング
- 複数のファイル/コンポーネントに影響がある場合
- 要件が不明確または曖昧な場合

## プロセス

### 1. 要件の再確認
- ユーザーのリクエストを完全に理解
- 成功基準を明確化
- 前提条件と制約を特定

### 2. アーキテクチャ分析
- 既存のコードベース構造を分析
- 影響を受けるコンポーネントを特定
- 再利用可能なパターンを検討

### 3. ステップ分解
各ステップに以下を含める：
- 明確で具体的なアクション
- ファイルパスと場所
- ステップ間の依存関係
- 推定複雑度
- 潜在的リスク

### 4. 実装順序
- 依存関係で優先順位付け
- 関連する変更をグループ化
- コンテキストスイッチを最小化
- 段階的テストを可能に

## 計画フォーマット

```markdown
# 実装計画: [機能名]

## 概要
[2-3文の要約]

## 要件
- [要件1]
- [要件2]

## アーキテクチャ変更
- [変更1: ファイルパスと説明]
- [変更2: ファイルパスと説明]

## 実装ステップ

### フェーズ1: [フェーズ名]
1. **[ステップ名]** (ファイル: path/to/file.ts)
   - アクション: 具体的なアクション
   - 理由: このステップの理由
   - 依存: なし / ステップXが必要
   - リスク: 低/中/高

### フェーズ2: [フェーズ名]
...

## テスト戦略
- ユニットテスト: [テスト対象ファイル]
- 統合テスト: [テスト対象フロー]
- E2Eテスト: [テスト対象ユーザージャーニー]

## リスクと対策
- **リスク**: [説明]
  - 対策: [対処方法]

## 成功基準
- [ ] 基準1
- [ ] 基準2

**確認待ち**: この計画で進めますか？(yes/no/修正内容)
```

## 重要な注意事項

**クリティカル**: 計画を提示した後、ユーザーが明示的に「yes」「進めて」などで確認するまでコードを書き始めてはいけません。

修正が必要な場合：
- 「修正: [変更内容]」
- 「別のアプローチ: [代替案]」
- 「フェーズ2をスキップしてフェーズ3を先に」

## 関連ワークフロー

計画後：
- `/tdd` でテスト駆動開発
- `/build-fix` でビルドエラー修正
- `/code-review` で完成後のレビュー
